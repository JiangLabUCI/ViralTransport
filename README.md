
# Norovirus Transport Model in Lettuce

## Introduction

 This project presents a selection of the scripts and results associated with the paper titled "Quantification of norovirus internalization in lettuce from irrigation water and associated health risk ". The contents are summarized below :

## Data

 File | Description
 --- | ---
 dicaprio_leaf_all.csv | Contains leaf NoV load data from DiCaprio et. al (2012) , Fig 8C extracted from the image using WebPlotDigitizer. First column has labels and second column the values. Row 1 is mean log10 load without RNASE. Row 2 is mean log10 load without RNASE + std. dev. of log10 load without RNASE. Row 3 is mean log10 load with RNASE. Row 2 is mean log10 load with RNASE + std. dev. of log10 load without RNASE. Subsequent rows proceed in the same order for the remaining time points.
 dicaprio_root_all.csv | Contains root NoV load data from DiCaprio et. al (2012) , Fig 8A extracted from the image using WebPlotDigitizer. First column has labels and second column the values. Row 1 is mean log10 load without RNASE. Row 2 is mean log10 load without RNASE + std. dev. of log10 load without RNASE. Row 3 is mean log10 load with RNASE. Row 2 is mean log10 load with RNASE + std. dev. of log10 load without RNASE. Subsequent rows proceed in the same order for the remaining time points.
 hnv_fwater_dicaprio.csv | Contains feedwater NoV load data from DiCaprio et. al(2012), Fig 5. First column is the time points, second column is the log10 load.
 irrigation.mat | Binary array (0 or 1) with 1s on the days lettuce is irrigated from Gallado et. al (1996), Fig 3.
 secon.mat | NoV concentration (genome/mL) in secondary effluent used for irrigation, from Lim and Jiang (2016).
 transpiration_gallardo.csv | Transpiration from Gallardo et. al (1996), Fig 3.

## Scripts

 This contains the scripts which utilize functions from the directory `funcs` to carry out different computations. Some of them read parameters from a coresponding text file and these are listed below :

Filename | Description | Parameter filename
 ---|---|---
annrisk.m | Compute annual risk from daily risk. |-
consump_samples.m | Sample for consumption and bodyweight. |-
fitHydroponic.m | Fit data from DiCaprio et. al (2012) to hydroponically grown lettuce. |deparamlist.txt
getmodelopsH.m | Output hydroponic model simulation values. |moparamlist.txt
ppdH2.m | Find posterior prediction intervals for hydroponic lettuce. |ppdparams2.txt
riskH4.m | Daily risk of hydroponic lettuce. |rparamlistH4.txt
risklandscape1o3.m | Compute risk for range of values of attach-detach kinetic constants.  |rlparams.txt
scaller2o3.m | Compute risk for soil grown lettuce. |sparams2o3.txt
calc_hypergeom.nb* | Compute the risk for the Hypergeometic model | -

 \* _Mathematica notebook_

Detailed descriptions and comments can be found inside these files. Help can also be viewed for these files in the MATLAB console in the usual way. E.g, for `annrisk.m`, typing:

 ```MATLAB
>> help annrisk
```

in the MATLAB console will print:
>__annrisk__ Annual risk from daily risk.
>
>  Computes distributions of annual risk of infection and annual disease
>  burden of hydroponic/soil grown lettuce when supplied the daily risk
>  distribution.

Additionally this directory also contains text files that the scripts read parameters from. The parameters are defined in a separate file to permit compilation of MATLAB code using the `mcc` command.

## Results

The results directory has the `.mat` files generated by the scripts. These are then used by other scripts or plotting functions. Each filename is prepended with a serial number for unique identification. No two files share the same serial number. These files described below :

Filename | Generating script | Parameters
--- | --- | ---
1182236_DEMC_firsto_20000g32p0lb100ub30F0lam.mat | fitHydroponic.m |  20000,32,32,0.3,0,-9,6,2,1,1,1,1,0
1182237_DEMC_adscnt_20000g32p0lb100ub30F0lam.mat | fitHydroponic.m |  20000,32,32,0.3,0,-9,6,2,2,1,1,1,0
1182754_1182236_10000_modelopsH.mat | getmodelopsH.m | 20000 0.5 1182236_DEMC_firsto_20000g32p0lb100ub30F0lam.mat 6 32
1182755_1182237_10000_modelopsH.mat | getmodelopsH.m | 20000 0.5 1182237_DEMC_adscnt_20000g32p0lb100ub30F0lam.mat 6 32
2208542_s2o3_1182237_adscnt_10000.mat | scaller2o3.m | 1182237_DEMC_adscnt_20000g32p0lb100ub30F0lam.mat 6 8 10000 1 1
2208555_s2o3_1182237_adscnt_10000.mat | scaller2o3.m | 1182237_DEMC_adscnt_20000g32p0lb100ub30F0lam.mat 6 8 10000 6 6
2703562_1182236_firsto_10000sa10000bi6ouH4.mat* | riskH4.m | 10000 0.5 1182236_DEMC_firsto_20000g32p0lb100ub30F0lam.mat 1182754_1182236_10000_modelopsH.mat 6 10 2 800 8000 80000
2703562_1182237_firsto_10000sa10000bi6ouH4.mat* | riskH4.m | 10000 0.5 1182237_DEMC_adscnt_20000g32p0lb100ub30F0lam.mat 1182755_1182237_10000_modelopsH.mat 6 10 2 800 8000 80000
2703562_1182237_firsto_10000sa10000bi6ouH4_hyp.mat | calc_hypergeom | -
consumpsamp2.mat | consump_samples.m | -

\* _See `sparams2o3.txt` inside `./scripts/`` for exact format._

## Functions

This directory has auxiliary code required by the main scripts. It has the following files.

Filename | Description
 ---|---
bpv.m |Vectorized beta-Poisson dose-response model.
DE_MC.m |Differential Evolution Markov Chain (ter Braak, 2006)
fp.m |Vectorized fractional Poisson dose-response model.
hyd_load_data.m |Load data for hydroponic lettuce
remout_simple.m |Naive outlier removal from a DE/DEMC solset object.
smodel2o1.m |Model for lettuce grown in the soil.
soil_load_data.m | Load data for soil lettuce
sse_water.m |Objective function value for a given set of parameters.
wmodel4o1.m |Model for lettuce grown hydroponically.

Detailed comments are seen inside each file. Similar to scripts,`help` can be used. For e.g,

```MATLAB
>> help bpv
```

in the MATLAB console will print:
>__bpv__ Vectorized beta-Poisson dose-response model.
>
>   C = bpv(dose, alpha, beta) computes probability of infection assuming
>   a beta-Poisson dose-response model. dose can be a vector. alpha and
>   beta must be scalars.  

## Citing this work

 If you use our code or part of it in your work, please cite the paper below:

 ```LaTeX
 Chandrasekaran, S., & Jiang, S. C. (2018). A dynamic transport model for quantification of norovirus internalization in lettuce from irrigation water and associated health risk. Science of The Total Environment, 643, 751â€“761. http://doi.org/10.1016/j.scitotenv.2018.06.158
 ```